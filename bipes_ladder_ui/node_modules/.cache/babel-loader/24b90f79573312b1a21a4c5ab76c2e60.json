{"ast":null,"code":"import _defineProperty from \"/home/andouglas/Documents/BipesLadder/BipesLadder/bipes_ladder_ui/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/andouglas/Documents/BipesLadder/BipesLadder/bipes_ladder_ui/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/home/andouglas/Documents/BipesLadder/BipesLadder/bipes_ladder_ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/andouglas/Documents/BipesLadder/BipesLadder/bipes_ladder_ui/src/BipesLadder.jsx\";\nimport React, { useState, useCallback } from \"react\";\nimport { evaluate } from 'mathjs';\nimport DropZone from \"./DropZone\";\nimport TrashDropZone from \"./TrashDropZone\";\nimport SideBarItem from \"./SideBarItem\";\nimport Row from \"./Row\";\nimport initialData from \"./initial-data\";\nimport { handleMoveWithinParent, handleMoveToDifferentParent, handleMoveSidebarComponentIntoParent, handleRemoveItemFromLayout, parseJSON, createJSON } from \"./helpers\";\nimport { SIDEBAR_ITEMS, SIDEBAR_ITEMS_OTHER, SIDEBAR_ITEM, ITEMS_CHANGED, COMPONENT, COLUMN, ITEM_CHANGED, STANDARD_COMPONENT } from \"./constants\";\nimport shortid from \"shortid\";\nimport ReactDOM from \"react-dom\";\nimport Button from \"@material-ui/core/Button\";\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport NavigationIcon from \"@material-ui/icons/Navigation\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport PlayCircleOutlineIcon from \"@material-ui/icons/PlayCircleOutline\";\nimport ClearAllIcon from \"@material-ui/icons/ClearAll\";\nimport { Component } from \"react\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Column, { parallelLines } from \"./Column\";\n\nfunction Container() {\n  var _this = this;\n\n  var initialLayout = initialData.layout;\n  var initialComponents = initialData.components;\n\n  var _useState = useState(initialLayout),\n      _useState2 = _slicedToArray(_useState, 2),\n      layout = _useState2[0],\n      setLayout = _useState2[1];\n\n  var _useState3 = useState(initialComponents),\n      _useState4 = _slicedToArray(_useState3, 2),\n      components = _useState4[0],\n      setComponents = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      address = _useState6[0],\n      setAddress = _useState6[1];\n\n  var addressArray = [];\n\n  var addressFromRow = function addressFromRow(addresses) {\n    //addressArray.push(addresses[0]);\n    setAddress(addresses);\n    console.log(address);\n  };\n\n  var handleDropToTrashBin = useCallback(function (dropZone, item) {\n    console.log(item.path);\n    var splitItemPath = item.path.split(\"-\");\n    setLayout(handleRemoveItemFromLayout(layout, splitItemPath));\n    address.map(function (row, index) {\n      console.log(row);\n\n      if (row.args.path == item.path) {\n        address.splice(index);\n      }\n    });\n  }, [layout]);\n  var handleDrop = useCallback(function (dropZone, item) {\n    var splitDropZonePath = dropZone.path.split(\"-\");\n    var pathToDropZone = splitDropZonePath.slice(0, -1).join(\"-\");\n    console.log(item);\n    var newItem = {\n      id: shortid.generate(),\n      type: item.type\n    };\n\n    if (item.type === COLUMN) {\n      newItem.children = item.children;\n    } // sidebar into\n\n\n    if (item.type === SIDEBAR_ITEM) {\n      // 1. Move sidebar item into page\n      var newComponent = {\n        id: shortid.generate(),\n        component: _objectSpread({}, item.component)\n      };\n      console.log(newComponent);\n      var _newItem = {\n        id: newComponent.id,\n        type: COMPONENT,\n        component: {\n          row: splitDropZonePath[2],\n          column: splitDropZonePath[1],\n          color: \"Black\"\n        }\n      };\n      setComponents(_objectSpread({}, components, _defineProperty({}, newComponent.id, newComponent)));\n      setLayout(handleMoveSidebarComponentIntoParent(layout, splitDropZonePath, _newItem));\n      return;\n    } // move down here since sidebar items dont have path\n\n\n    var splitItemPath = item.path.split(\"-\");\n    var pathToItem = splitItemPath.slice(0, -1).join(\"-\");\n    console.log(splitItemPath, pathToItem); // 2. Pure move (no create)\n\n    if (splitItemPath.length === splitDropZonePath.length) {\n      // 2.a. move within parent\n      if (pathToItem === pathToDropZone) {\n        setLayout(handleMoveWithinParent(layout, splitDropZonePath, splitItemPath));\n        return;\n      } // 2.b. OR move different parent\n      // TODO FIX columns. item includes children\n\n\n      setLayout(handleMoveToDifferentParent(layout, splitDropZonePath, splitItemPath, item));\n      return;\n    } // 3. Move + Create\n\n\n    setLayout(handleMoveToDifferentParent(layout, splitDropZonePath, splitItemPath, newItem));\n  }, [layout, components]);\n\n  var renderRow = function renderRow(row, currentPath) {\n    return /*#__PURE__*/React.createElement(Row, {\n      key: row.id,\n      data: row,\n      handleDrop: handleDrop,\n      components: components,\n      path: currentPath,\n      addressFromRow: addressFromRow,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 7\n      }\n    });\n  };\n\n  function checkParallelLines(row) {\n    var linePairs = [];\n    var initialLine = 0;\n    var parallelLinesOrdered = [];\n    console.log(parallelLines);\n    parallelLines[row].map(function (path, index) {\n      if (path != \"\") {\n        var splitItemPath = path.split(\"-\");\n        var pathToItem = splitItemPath[1];\n        parallelLinesOrdered.push(Number(pathToItem));\n        parallelLinesOrdered.sort(function (a, b) {\n          return a - b;\n        });\n        console.log(parallelLinesOrdered);\n      }\n    });\n    parallelLinesOrdered.map(function (pathOrdererd, index) {\n      if (pathOrdererd > initialLine) {\n        linePairs.push([initialLine, pathOrdererd]);\n        initialLine = pathOrdererd;\n      }\n    });\n    return linePairs;\n  }\n\n  function splitPath(path) {\n    var splittedPath = path.split(\"-\");\n    if (path == \"\") return -1;\n    return {\n      line: splittedPath[0],\n      column: splittedPath[1],\n      row: splittedPath[2]\n    };\n  }\n\n  function joinPath(row, column, line) {\n    return line + \"-\" + column + \"-\" + row;\n  }\n\n  function operation(op, firstComponent, secondComponent) {\n    if (firstComponent.row == -1) return secondComponent;\n    if (secondComponent.row == -1) return firstComponent;\n    var row = firstComponent.row;\n    var address = \"(\" + firstComponent.args.address + op + secondComponent.args.address + \")\";\n    var splittedPathFirstComponent = splitPath(firstComponent.args.path);\n    var splittedPathSecondComponent = splitPath(secondComponent.args.path);\n    var path = joinPath(Math.min(splittedPathFirstComponent.row, splittedPathSecondComponent.row), Math.min(splittedPathFirstComponent.column, splittedPathSecondComponent.column), splittedPathFirstComponent.line);\n    var type = op + \"_operation\";\n    var newComponent = {\n      row: row,\n      args: {\n        address: address,\n        path: path,\n        type: type\n      }\n    };\n    return newComponent;\n  }\n\n  function sortAddressByPath(address, row) {\n    var newAddress = new Array(2).fill(STANDARD_COMPONENT).map(function () {\n      return new Array(13).fill(STANDARD_COMPONENT);\n    });\n    console.info(newAddress);\n    var line = [];\n    address.map(function (component, index) {\n      if (component.args != \"\" && component.row == row) {\n        var _row = splitPath(component.args.path).row;\n        var col = splitPath(component.args.path).column;\n        console.log(_row, col);\n        newAddress[_row][col] = component;\n      }\n    });\n    return newAddress;\n  }\n\n  function getExpression(linePairs, row) {\n    var addressOrdered = sortAddressByPath(address, row);\n    var expression = STANDARD_COMPONENT;\n    var componentsIntoLinePair = [];\n\n    if (linePairs.length > 0) {\n      console.log(\"Parallel Lines\", linePairs, row);\n      linePairs.map(function (pair, index) {\n        componentsIntoLinePair = [];\n\n        for (var _row2 = 0; _row2 < 2; _row2++) {\n          expression = STANDARD_COMPONENT;\n\n          for (var col = pair[0]; col < pair[1]; col++) {\n            if (addressOrdered[_row2][col].row == -1 || addressOrdered[_row2][col].args.type == \"coil\") break;\n            console.log(_row2, col);\n            expression = operation(\" and \", addressOrdered[_row2][col], expression);\n            addressOrdered[_row2][col] = STANDARD_COMPONENT;\n            var _newPath = expression.args.path;\n            addressOrdered[splitPath(_newPath).row][splitPath(_newPath).column] = expression;\n          }\n\n          componentsIntoLinePair.push(expression);\n          console.log(componentsIntoLinePair);\n        }\n\n        expression = STANDARD_COMPONENT;\n        componentsIntoLinePair.map(function (component, index) {\n          expression = operation(\" or \", component, expression);\n          console.log(expression);\n        });\n        console.log(expression);\n        var newPath = expression.args.path;\n        console.log(newPath, \"teste\");\n\n        if (splitPath(newPath) != -1) {\n          var _row3 = splitPath(newPath).row;\n          var _col = splitPath(newPath).column;\n          addressOrdered[_row3][_col] = expression;\n          console.log(addressOrdered);\n        }\n      });\n    }\n\n    var output = [];\n    expression = STANDARD_COMPONENT;\n    addressOrdered[0].map(function (component, index) {\n      if (component.args.type != \"coil\") {\n        console.log(component, expression);\n        expression = operation(\" and \", component, expression);\n      }\n    });\n\n    for (var index = 0; index < addressOrdered.length; index++) {\n      var lineAddressOrderedLength = addressOrdered[0].length;\n      var comp = addressOrdered[index][lineAddressOrderedLength - 1];\n\n      if (comp != undefined) {\n        output.push(comp);\n      }\n    }\n\n    return [expression.args.address, output];\n  }\n\n  var generateCode = useCallback(function () {\n    var finalExpression = [];\n    var layoutForSave = layout;\n    layout.map(function (row, rowIndex) {\n      var outs = [];\n      var linePairs = checkParallelLines(rowIndex);\n      var obj = {};\n      obj.row = rowIndex;\n\n      var _getExpression = getExpression(linePairs, rowIndex),\n          _getExpression2 = _slicedToArray(_getExpression, 2),\n          expression = _getExpression2[0],\n          outputs = _getExpression2[1];\n\n      obj.expression = expression;\n      outputs.map(function (output, index) {\n        outs.push(output.args.address);\n      });\n      obj.outputs = outs;\n      finalExpression.push(obj);\n    });\n    var json = createJSON(finalExpression);\n    setJsonExpression(json);\n    var scope = {\n      A: 1,\n      B: 0,\n      C: 1\n    };\n    console.log(String(parseJSON(json)[0].expression));\n    console.log(evaluate(String(parseJSON(json)[0].expression), scope));\n    setLayout(layoutForSave);\n    alert(json);\n  });\n  var clearAllComponents = useCallback(function () {\n    var layout = [];\n    setLayout(layout);\n  });\n  var addnewLine = useCallback(function () {\n    var itens = [components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.lineComponent, components.openedContactComponent];\n    var newLayout = handleMoveSidebarComponentIntoParent(layout, [layout.length], components.coilComponent);\n    setLayout(newLayout);\n    itens.map(function (item, index) {\n      var nextComponentLayout = handleMoveSidebarComponentIntoParent(newLayout, [layout.length, 0], item);\n      setLayout(nextComponentLayout);\n      newLayout = nextComponentLayout;\n    });\n  }); //return <React.Fragment key={row.id}>{renderRow(row, 1)}</React.Fragment>;\n  // dont use index for key when mapping over items\n  // causes this issue - https://github.com/react-dnd/react-dnd/issues/342\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 408,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"head_top\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: \"right\",\n      float: \"right\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"./images/if_logo.png\",\n    width: \"70\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 9\n    }\n  }, \"BIPES LADDER\"), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"menu\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Fab, {\n    variant: \"extended\",\n    \"aria-label\": \"add\",\n    style: {\n      margin: \"2px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    color: \"primary\",\n    onClick: generateCode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PlayCircleOutlineIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 15\n    }\n  }), \" EXECUTAR\")), /*#__PURE__*/React.createElement(Fab, {\n    variant: \"extended\",\n    \"aria-label\": \"add\",\n    style: {\n      margin: \"2px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(SaveAltIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 15\n    }\n  }), \" SALVAR\")))), /*#__PURE__*/React.createElement(\"div\", {\n    class: \"inner_body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"sideBar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 11\n    }\n  }, \"CONTATOS\"), Object.values(SIDEBAR_ITEMS).map(function (sideBarItem, index) {\n    return /*#__PURE__*/React.createElement(SideBarItem, {\n      key: sideBarItem.id,\n      data: sideBarItem,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 13\n      }\n    });\n  }), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 11\n    }\n  }, \"OUTROS\"), Object.values(SIDEBAR_ITEMS_OTHER).map(function (sideBarItem, index) {\n    return /*#__PURE__*/React.createElement(SideBarItem, {\n      key: sideBarItem.id,\n      data: sideBarItem,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 13\n      }\n    });\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pageContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"page\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    class: \"menu\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Fab, {\n    \"aria-label\": \"add\",\n    style: {\n      margin: \"2px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    color: \"secondary\",\n    onClick: addnewLine,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(AddIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 19\n    }\n  }))), /*#__PURE__*/React.createElement(Fab, {\n    \"aria-label\": \"clear\",\n    style: {\n      margin: \"2px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(IconButton, {\n    color: \"secondary\",\n    onClick: clearAllComponents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(ClearAllIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 19\n    }\n  })))), layout.map(function (row, index) {\n    var currentPath = \"\".concat(index);\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      key: row.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"style_modal\",\n      style: {\n        border: \"2px solid #ABC\",\n        marginBottom: \"10px\",\n        padding: \"5px\",\n        backgroundColor: \"lightgreen\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 19\n      }\n    }, \"LINHA \", index + 1), renderRow(row, currentPath));\n  }), /*#__PURE__*/React.createElement(TrashDropZone, {\n    data: {\n      layout: layout\n    },\n    onDrop: handleDropToTrashBin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pageTest\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 11\n    }\n  }))));\n}\n\nexport default Container;","map":{"version":3,"sources":["/home/andouglas/Documents/BipesLadder/BipesLadder/bipes_ladder_ui/src/BipesLadder.jsx"],"names":["React","useState","useCallback","evaluate","DropZone","TrashDropZone","SideBarItem","Row","initialData","handleMoveWithinParent","handleMoveToDifferentParent","handleMoveSidebarComponentIntoParent","handleRemoveItemFromLayout","parseJSON","createJSON","SIDEBAR_ITEMS","SIDEBAR_ITEMS_OTHER","SIDEBAR_ITEM","ITEMS_CHANGED","COMPONENT","COLUMN","ITEM_CHANGED","STANDARD_COMPONENT","shortid","ReactDOM","Button","Fab","AddIcon","SaveAltIcon","EditIcon","NavigationIcon","FavoriteIcon","PlayCircleOutlineIcon","ClearAllIcon","Component","IconButton","Column","parallelLines","Container","initialLayout","layout","initialComponents","components","setLayout","setComponents","address","setAddress","addressArray","addressFromRow","addresses","console","log","handleDropToTrashBin","dropZone","item","path","splitItemPath","split","map","row","index","args","splice","handleDrop","splitDropZonePath","pathToDropZone","slice","join","newItem","id","generate","type","children","newComponent","component","column","color","pathToItem","length","renderRow","currentPath","checkParallelLines","linePairs","initialLine","parallelLinesOrdered","push","Number","sort","a","b","pathOrdererd","splitPath","splittedPath","line","joinPath","operation","op","firstComponent","secondComponent","splittedPathFirstComponent","splittedPathSecondComponent","Math","min","sortAddressByPath","newAddress","Array","fill","info","col","getExpression","addressOrdered","expression","componentsIntoLinePair","pair","newPath","output","lineAddressOrderedLength","comp","undefined","generateCode","finalExpression","layoutForSave","rowIndex","outs","obj","outputs","json","setJsonExpression","scope","A","B","C","String","alert","clearAllComponents","addnewLine","itens","lineComponent","openedContactComponent","newLayout","coilComponent","nextComponentLayout","textAlign","float","margin","Object","values","sideBarItem","border","marginBottom","padding","backgroundColor"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport {evaluate} from 'mathjs';\n\nimport DropZone from \"./DropZone\";\nimport TrashDropZone from \"./TrashDropZone\";\n\nimport SideBarItem from \"./SideBarItem\";\nimport Row from \"./Row\";\nimport initialData from \"./initial-data\";\nimport {\n  handleMoveWithinParent,\n  handleMoveToDifferentParent,\n  handleMoveSidebarComponentIntoParent,\n  handleRemoveItemFromLayout,\n  parseJSON,\n  createJSON,\n} from \"./helpers\";\n\nimport {\n  SIDEBAR_ITEMS,\n  SIDEBAR_ITEMS_OTHER,\n  SIDEBAR_ITEM,\n  ITEMS_CHANGED,\n  COMPONENT,\n  COLUMN,\n  ITEM_CHANGED,\n  STANDARD_COMPONENT,\n} from \"./constants\";\nimport shortid from \"shortid\";\n\nimport ReactDOM from \"react-dom\";\nimport Button from \"@material-ui/core/Button\";\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport NavigationIcon from \"@material-ui/icons/Navigation\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport PlayCircleOutlineIcon from \"@material-ui/icons/PlayCircleOutline\";\nimport ClearAllIcon from \"@material-ui/icons/ClearAll\";\nimport { Component } from \"react\";\nimport IconButton from \"@material-ui/core/IconButton\";\n\nimport Column, { parallelLines } from \"./Column\";\n\nfunction Container() {\n  const initialLayout = initialData.layout;\n  const initialComponents = initialData.components;\n  const [layout, setLayout] = useState(initialLayout);\n  const [components, setComponents] = useState(initialComponents);\n  const [address, setAddress] = useState([]);\n  var addressArray = [];\n\n  const addressFromRow = (addresses) => {\n    //addressArray.push(addresses[0]);\n    setAddress(addresses);\n    console.log(address);\n  };\n\n  const handleDropToTrashBin = useCallback(\n    (dropZone, item) => {\n      console.log(item.path);\n      const splitItemPath = item.path.split(\"-\");\n      setLayout(handleRemoveItemFromLayout(layout, splitItemPath));\n      address.map((row, index) => {\n        console.log(row);\n        if (row.args.path == item.path) {\n          address.splice(index);\n        }\n      });\n    },\n    [layout]\n  );\n\n  const handleDrop = useCallback(\n    (dropZone, item) => {\n      const splitDropZonePath = dropZone.path.split(\"-\");\n\n      const pathToDropZone = splitDropZonePath.slice(0, -1).join(\"-\");\n      console.log(item);\n\n      const newItem = { id: shortid.generate(), type: item.type };\n      if (item.type === COLUMN) {\n        newItem.children = item.children;\n      }\n\n      // sidebar into\n      if (item.type === SIDEBAR_ITEM) {\n        // 1. Move sidebar item into page\n        const newComponent = {\n          id: shortid.generate(),\n          component: {\n            ...item.component,\n          },\n        };\n        console.log(newComponent);\n        const newItem = {\n          id: newComponent.id,\n          type: COMPONENT,\n          component: {\n            row: splitDropZonePath[2],\n            column: splitDropZonePath[1],\n            color: \"Black\",\n          },\n        };\n        setComponents({\n          ...components,\n          [newComponent.id]: newComponent,\n        });\n        setLayout(\n          handleMoveSidebarComponentIntoParent(\n            layout,\n            splitDropZonePath,\n            newItem\n          )\n        );\n        return;\n      }\n\n      // move down here since sidebar items dont have path\n      const splitItemPath = item.path.split(\"-\");\n      const pathToItem = splitItemPath.slice(0, -1).join(\"-\");\n      console.log(splitItemPath, pathToItem);\n\n      // 2. Pure move (no create)\n      if (splitItemPath.length === splitDropZonePath.length) {\n        // 2.a. move within parent\n        if (pathToItem === pathToDropZone) {\n          setLayout(\n            handleMoveWithinParent(layout, splitDropZonePath, splitItemPath)\n          );\n          return;\n        }\n\n        // 2.b. OR move different parent\n        // TODO FIX columns. item includes children\n        setLayout(\n          handleMoveToDifferentParent(\n            layout,\n            splitDropZonePath,\n            splitItemPath,\n            item\n          )\n        );\n        return;\n      }\n\n      // 3. Move + Create\n      setLayout(\n        handleMoveToDifferentParent(\n          layout,\n          splitDropZonePath,\n          splitItemPath,\n          newItem\n        )\n      );\n    },\n    [layout, components]\n  );\n\n  const renderRow = (row, currentPath) => {\n    return (\n      <Row\n        key={row.id}\n        data={row}\n        handleDrop={handleDrop}\n        components={components}\n        path={currentPath}\n        addressFromRow={addressFromRow}\n      />\n    );\n  };\n\n  function checkParallelLines(row) {\n    const linePairs = [];\n    var initialLine = 0;\n    var parallelLinesOrdered = [];\n    console.log(parallelLines);\n    parallelLines[row].map((path, index) => {\n      if (path != \"\") {\n        const splitItemPath = path.split(\"-\");\n        const pathToItem = splitItemPath[1];\n        parallelLinesOrdered.push(Number(pathToItem));\n        parallelLinesOrdered.sort(function (a, b) {\n          return a - b;\n        });\n        console.log(parallelLinesOrdered);\n      }\n    });\n\n    parallelLinesOrdered.map((pathOrdererd, index) => {\n      if (pathOrdererd > initialLine) {\n        linePairs.push([initialLine, pathOrdererd]);\n        initialLine = pathOrdererd;\n      }\n    });\n\n    return linePairs;\n  }\n\n  function splitPath(path) {\n    var splittedPath = path.split(\"-\");\n    if (path == \"\") return -1;\n    return {\n      line: splittedPath[0],\n      column: splittedPath[1],\n      row: splittedPath[2],\n    };\n  }\n\n  function joinPath(row, column, line) {\n    return line + \"-\" + column + \"-\" + row;\n  }\n\n  function operation(op, firstComponent, secondComponent) {\n    if (firstComponent.row == -1) return secondComponent;\n    if (secondComponent.row == -1) return firstComponent;\n    const row = firstComponent.row;\n    const address =\n      \"(\" +\n      firstComponent.args.address +\n      op +\n      secondComponent.args.address +\n      \")\";\n    const splittedPathFirstComponent = splitPath(firstComponent.args.path);\n    const splittedPathSecondComponent = splitPath(secondComponent.args.path);\n    const path = joinPath(\n      Math.min(splittedPathFirstComponent.row, splittedPathSecondComponent.row),\n      Math.min(\n        splittedPathFirstComponent.column,\n        splittedPathSecondComponent.column\n      ),\n      splittedPathFirstComponent.line\n    );\n    const type = op + \"_operation\";\n    const newComponent = {\n      row: row,\n      args: {\n        address: address,\n        path: path,\n        type: type,\n      },\n    };\n    return newComponent;\n  }\n\n  function sortAddressByPath(address, row) {\n    var newAddress = new Array(2)\n      .fill(STANDARD_COMPONENT)\n      .map(() => new Array(13).fill(STANDARD_COMPONENT));\n    console.info(newAddress);\n    let line = [];\n    address.map((component, index) => {\n      if (component.args != \"\" && component.row == row) {\n        const row = splitPath(component.args.path).row;\n        const col = splitPath(component.args.path).column;\n        console.log(row, col);\n        newAddress[row][col] = component;\n      }\n    });\n\n    return newAddress;\n  }\n\n  function getExpression(linePairs, row) {\n    let addressOrdered = sortAddressByPath(address, row);\n    let expression = STANDARD_COMPONENT;\n    let componentsIntoLinePair = [];\n\n    if (linePairs.length > 0) {\n      console.log(\"Parallel Lines\", linePairs, row);\n      linePairs.map((pair, index) => {\n        componentsIntoLinePair = [];\n        for (let row = 0; row < 2; row++) {\n          expression = STANDARD_COMPONENT;\n          for (let col = pair[0]; col < pair[1]; col++) {\n            if (\n              addressOrdered[row][col].row == -1 ||\n              addressOrdered[row][col].args.type == \"coil\"\n            )\n              break;\n            console.log(row, col);\n            expression = operation(\" and \", addressOrdered[row][col], expression);\n\n            addressOrdered[row][col] = STANDARD_COMPONENT;\n            const newPath = expression.args.path;\n            addressOrdered[splitPath(newPath).row][splitPath(newPath).column] =\n              expression;\n          }\n          componentsIntoLinePair.push(expression);\n          console.log(componentsIntoLinePair);\n        }\n\n        expression = STANDARD_COMPONENT;\n        componentsIntoLinePair.map((component, index) => {\n          expression = operation(\" or \", component, expression);\n          console.log(expression);\n        });\n        console.log(expression);\n        const newPath = expression.args.path;\n        console.log(newPath, \"teste\");\n        if (splitPath(newPath) != -1) {\n          const row = splitPath(newPath).row;\n          const col = splitPath(newPath).column;\n\n          addressOrdered[row][col] = expression;\n          console.log(addressOrdered);\n        }\n      });\n    }\n    let output = [];\n    expression = STANDARD_COMPONENT;\n    addressOrdered[0].map((component, index) => {\n      if (component.args.type != \"coil\") {\n        console.log(component, expression);\n        expression = operation(\" and \", component, expression);\n      }\n    });\n    for (let index = 0; index < addressOrdered.length; index++) {\n      const lineAddressOrderedLength = addressOrdered[0].length;\n      let comp = addressOrdered[index][lineAddressOrderedLength - 1];\n      if (comp != undefined) {\n        output.push(comp);\n      }\n    }\n\n    return [expression.args.address, output];\n  }\n\n  const generateCode = useCallback(() => {\n    let finalExpression = [];\n    let layoutForSave = layout;\n    \n\n    layout.map((row, rowIndex) => {\n      let outs = [];\n      var linePairs = checkParallelLines(rowIndex);\n      \n      let obj = {};\n      obj.row = rowIndex;\n      var [expression, outputs] = getExpression(linePairs, rowIndex);\n      obj.expression = expression;\n      outputs.map((output, index) => {\n        outs.push(output.args.address);\n      });\n      obj.outputs = outs;\n\n      finalExpression.push(obj);\n    });\n    var json = createJSON(finalExpression);\n    setJsonExpression(json);\n    let scope = {\n      A: 1,\n      B: 0, \n      C: 1\n    }\n    console.log(String(parseJSON(json)[0].expression));\n    console.log(evaluate(String(parseJSON(json)[0].expression), scope));\n    setLayout(layoutForSave);\n    alert(json);\n  });\n\n  const clearAllComponents = useCallback(() => {\n    const layout = [];\n    setLayout(layout);\n  });\n\n  const addnewLine = useCallback(() => {\n    var itens = [\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.lineComponent,\n      components.openedContactComponent,\n    ];\n\n    let newLayout = handleMoveSidebarComponentIntoParent(\n      layout,\n      [layout.length],\n      components.coilComponent\n    );\n    setLayout(newLayout);\n\n    itens.map((item, index) => {\n      let nextComponentLayout = handleMoveSidebarComponentIntoParent(\n        newLayout,\n        [layout.length, 0],\n        item\n      );\n      setLayout(nextComponentLayout);\n      newLayout = nextComponentLayout;\n    });\n  });\n\n  //return <React.Fragment key={row.id}>{renderRow(row, 1)}</React.Fragment>;\n\n  // dont use index for key when mapping over items\n  // causes this issue - https://github.com/react-dnd/react-dnd/issues/342\n  return (\n    <div className=\"body\">\n      <div class=\"head_top\">\n        <div style={{ textAlign: \"right\", float: \"right\" }}>\n          <img src=\"./images/if_logo.png\" width=\"70\"></img>\n        </div>\n        <h2>BIPES LADDER</h2>\n        <div class=\"menu\">\n          <Fab variant=\"extended\" aria-label=\"add\" style={{ margin: \"2px\" }}>\n            <IconButton color=\"primary\" onClick={generateCode}>\n              <PlayCircleOutlineIcon /> EXECUTAR\n            </IconButton>\n          </Fab>\n\n          <Fab variant=\"extended\" aria-label=\"add\" style={{ margin: \"2px\" }}>\n            <IconButton color=\"primary\">\n              <SaveAltIcon /> SALVAR\n            </IconButton>\n          </Fab>\n        </div>\n      </div>\n      <div class=\"inner_body\">\n        <div className=\"sideBar\">\n          <h3>CONTATOS</h3>\n          {Object.values(SIDEBAR_ITEMS).map((sideBarItem, index) => (\n            <SideBarItem key={sideBarItem.id} data={sideBarItem} />\n          ))}\n          <h3>OUTROS</h3>\n          {Object.values(SIDEBAR_ITEMS_OTHER).map((sideBarItem, index) => (\n            <SideBarItem key={sideBarItem.id} data={sideBarItem} />\n          ))}\n        </div>\n        <div className=\"pageContainer\">\n          <div className=\"page\">\n            <div class=\"menu\">\n              <Fab aria-label=\"add\" style={{ margin: \"2px\" }}>\n                <IconButton color=\"secondary\" onClick={addnewLine}>\n                  <AddIcon />\n                </IconButton>\n              </Fab>\n              <Fab aria-label=\"clear\" style={{ margin: \"2px\" }}>\n                <IconButton color=\"secondary\" onClick={clearAllComponents}>\n                  <ClearAllIcon />\n                </IconButton>\n              </Fab>\n            </div>\n\n            {layout.map((row, index) => {\n              const currentPath = `${index}`;\n\n              return (\n                <React.Fragment key={row.id}>\n                  <div\n                    class=\"style_modal\"\n                    style={{\n                      border: \"2px solid #ABC\",\n\n                      marginBottom: \"10px\",\n                      padding: \"5px\",\n                      backgroundColor: \"lightgreen\",\n                    }}\n                  >\n                    LINHA {index + 1}\n                  </div>\n                  {renderRow(row, currentPath)}\n                </React.Fragment>\n              );\n            })}\n            <TrashDropZone\n              data={{\n                layout,\n              }}\n              onDrop={handleDropToTrashBin}\n            />\n          </div>\n\n          <div className=\"pageTest\"></div>\n        </div>\n      </div>\n    </div>\n  );\n}\nexport default Container;\n"]},"metadata":{},"sourceType":"module"}